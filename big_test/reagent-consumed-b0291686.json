{
  "schemaVersion": "2.0.0",
  "id": "b0291686-edff-4d4b-bb59-c23710b9c0ff",
  "title": "Reagent consumed",
  "status": "EDITABLE",
  "version": null,
  "previousVersion": null,
  "metadata": {
    "index": "0",
    "createdAt": "1970-01-01T00:00:00.000Z",
    "lastUpdatedAt": "1970-01-01T00:00:00.000Z",
    "createdByRoleId": "44444444-4444-4444-8888-444444444444",
    "lastUpdatedByRoleId": "44444444-4444-4444-8888-444444444444",
    "editors": [],
    "typeIndex": "0"
  },
  "sourceInfo": {
    "template": {
      "id": "4a3102b9-7295-4dfd-b36a-3e66e5f951db",
      "version": "2"
    }
  },
  "fields": {},
  "kind": "INSTANCE",
  "type": {
    "ref": {
      "id": "4eb6726b-c745-4cd0-bf1b-ef63ad35840b"
    }
  },
  "content": {
    "type": "SCRIPT_CODE",
    "value": {
      "scriptCode": "# Get the entity where this script is embedded\ncontaining_entity = seal.get_containing_entity()\n\n# Get the \"Stock Unit\" reference field value\nstock_unit_field = containing_entity[\"fields\"].get(\"Stock Unit\")\n\nif stock_unit_field and stock_unit_field.get(\"value\"):\n    # Extract the ID of the referenced Stock Unit entity\n    stock_unit_ref_id = stock_unit_field[\"value\"][0][\"id\"]\n\n    # Make the referenced Stock Unit entity editable to create a new draft\n    # This also returns the new draft entity's data\n    stock_unit_draft_entity = seal.make_entity_editable(stock_unit_ref_id)\n    stock_unit_draft_id = stock_unit_draft_entity[\"id\"]\n\n    # Update the status tag of the new draft Stock Unit entity to \"Consumed\"\n    seal.update_entity_status_tag(stock_unit_draft_id, \"Consumed\")\n    print(f\"Status tag of Stock Unit entity '{stock_unit_draft_id}' updated to 'Consumed'.\")\n\n    # Update the \"Stock Unit\" reference in the containing entity to point to the new draft\n    # Set version to None for drafts\n    updated_stock_unit_ref = [{\"id\": stock_unit_draft_id, \"version\": None}]\n    seal.update_field_value(\"Stock Unit\", updated_stock_unit_ref)\n    print(f\"Containing entity's 'Stock Unit' reference updated to new draft '{stock_unit_draft_id}'.\")\n\n    # Check the \"Reagent consumed\" checkbox field in the containing entity\n    seal.update_field_value(\"Reagent consumed\", True)\n    print(\"Reagent consumed checkbox in the containing entity has been checked.\")\nelse:\n    print(\"No 'Stock Unit' reference found or field is empty. No action taken.\")\n"
    }
  }
}